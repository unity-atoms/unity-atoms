"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[701],{533:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/death-event-reference-411fe80b7dc5b1bd427e8080601a9031.png"},2363:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/hurt-all-monsters-f9484cff6d5f05a6e530fd5288b9aa82.png"},4009:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/orc-death-message-ff65fa235f407a78716ae8c13ad675fe.png"},4564:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/death-event-assigned-edeb9b13efde7ce23e5f7786d19c25f2.png"},5767:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/raise-damage-event-7c4d7e1ee01d13c0c7921af7ec4769c4.png"},7293:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/death-listener-9a2f1fb3d682e58f3dd07d0f93bb0d58.png"},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>d});var a=t(6540);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}},9077:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/monsters-took-damage-fd4d900ebeda162e30504b00afd3613c.png"},9153:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/unique-death-messages-ddc4de772ad6ac403b0ad4026a9bb6a7.png"},9864:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>c,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"tutorials/event-instancer","title":"Event Instancer","description":"Similar to Variables, Events can also be instantiated for use in prefabs. In this tutorial we will build a \\"death\\" Event for the monster prefab created in the variable instancer tutorial. The death Event will be fired once as the monster health drops below zero.","source":"@site/../docs/tutorials/event-instancer.md","sourceDirName":"tutorials","slug":"/tutorials/event-instancer","permalink":"/unity-atoms/docs/tutorials/event-instancer","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"Miika L\xf6nnqvist","lastUpdatedAt":1598177590000,"frontMatter":{"id":"event-instancer","title":"Event Instancer","hide_title":true,"sidebar_label":"Event Instancer"},"sidebar":"docs","previous":{"title":"Variable Instancer","permalink":"/unity-atoms/docs/tutorials/variable-instancer"},"next":{"title":"Generator","permalink":"/unity-atoms/docs/tutorials/generator"}}');var s=t(4848),i=t(8453);const r={id:"event-instancer",title:"Event Instancer",hide_title:!0,sidebar_label:"Event Instancer"},d="Event Instancer",o={},l=[{value:"Damage the monster",id:"damage-the-monster",level:2},{value:"Global damage event",id:"global-damage-event",level:2},{value:"Raising events from the inspector",id:"raising-events-from-the-inspector",level:2},{value:"Death event instancer",id:"death-event-instancer",level:2},{value:"Listening for the instantiated <code>Death</code> Event",id:"listening-for-the-instantiated-death-event",level:2},{value:"Testing the <code>Event Instancer</code>",id:"testing-the-event-instancer",level:2}];function h(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"event-instancer",children:"Event Instancer"})}),"\n",(0,s.jsx)(n.p,{children:'Similar to Variables, Events can also be instantiated for use in prefabs. In this tutorial we will build a "death" Event for the monster prefab created in the variable instancer tutorial. The death Event will be fired once as the monster health drops below zero.'}),"\n",(0,s.jsx)(n.p,{children:"Some setup is necessary in our example to demonstrate how an Event Instancer works."}),"\n",(0,s.jsx)(n.h2,{id:"damage-the-monster",children:"Damage the monster"}),"\n",(0,s.jsxs)(n.p,{children:["To inflict damage on the monster, we can add a method called ",(0,s.jsx)(n.code,{children:"Damage"})," to the ",(0,s.jsx)(n.code,{children:"LogHealth"})," script that subtracts from the current health of the monster:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cs",children:'using UnityEngine;\nusing UnityAtoms.BaseAtoms;\n\npublic class LogHealth : MonoBehaviour\n{\n    [SerializeField]\n    private IntReference health;\n    [SerializeField]\n    private IntConstant startHealth;\n\n    public void Start()\n    {\n        health.Value = startHealth.Value;\n    }\n\n    public void Damage(int damage)\n    {\n        health.Value -= damage;\n    }\n\n    public void ReportHealth(int health)\n    {\n        Debug.Log(gameObject.name + " reports: " +\n            "My health changed to " + health);\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["At this point ",(0,s.jsx)(n.code,{children:"LogHealth"})," as a name for the component is starting to lose it's meaning, but we'll keep extending the script for simplicity's sake."]}),"\n",(0,s.jsx)(n.h2,{id:"global-damage-event",children:"Global damage event"}),"\n",(0,s.jsxs)(n.p,{children:["To trigger the ",(0,s.jsx)(n.code,{children:"Damage"})," method, create a new ",(0,s.jsx)(n.code,{children:"IntEvent"})," called ",(0,s.jsx)(n.code,{children:"HurtAllMonsters"}),". Add a new ",(0,s.jsx)(n.code,{children:"Int Event Reference Listener"})," component to the ",(0,s.jsx)(n.code,{children:"Monster"})," base prefab. Have the listener call ",(0,s.jsx)(n.code,{children:"Damage"})," of ",(0,s.jsx)(n.code,{children:"LogHealth"}),":"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"hurt-all-monsters",src:t(2363).A+"",width:"547",height:"486"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Make sure the ",(0,s.jsx)(n.code,{children:"Damage"})," method is selected from the ",(0,s.jsx)(n.code,{children:"Dynamic"})," list of methods."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"raising-events-from-the-inspector",children:"Raising events from the inspector"}),"\n",(0,s.jsxs)(n.p,{children:["Run the scene and find the ",(0,s.jsx)(n.code,{children:"HurtAllMonsters"})," Event from your asset folders. Set the ",(0,s.jsx)(n.code,{children:"Inspector Raise Value"})," to any number and click the ",(0,s.jsx)(n.code,{children:"Raise"})," button."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"raise-damage-event",src:t(5767).A+"",width:"548",height:"231"})}),"\n",(0,s.jsx)(n.p,{children:"The monsters in the scene will take the entered amount of damage. Click the button multiple times to repeat inflicting the damage:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"monsters-took-damage",src:t(9077).A+"",width:"493",height:"236"})}),"\n",(0,s.jsx)(n.p,{children:"The setup is complete. We are now ready to instantiate a death Event for each monster."}),"\n",(0,s.jsx)(n.h2,{id:"death-event-instancer",children:"Death event instancer"}),"\n",(0,s.jsxs)(n.p,{children:["When the monster health reaches zero or lower, we want to fire a ",(0,s.jsx)(n.code,{children:"VoidEvent"})," to signal that this monster has perished. Listening for this Event in the prefab allows you to customize how each monster type dies. In this example, each monster reports a different death message."]}),"\n",(0,s.jsxs)(n.p,{children:["We need logic in the ",(0,s.jsx)(n.code,{children:"Damage"})," method to detect when they monster died and a reference to an Event we want to raise when that happens:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cs",children:'using UnityEngine;\nusing UnityAtoms.BaseAtoms;\n\npublic class LogHealth : MonoBehaviour\n{\n    [SerializeField]\n    private IntReference health;\n    [SerializeField]\n    private IntConstant startHealth;\n    [SerializeField]\n    private VoidBaseEventReference death;\n\n    public void Start()\n    {\n        health.Value = startHealth.Value;\n    }\n\n    public void Damage(int damage)\n    {\n        if(health.Value > 0)\n        {\n            health.Value -= damage;\n\n            if(health.Value <= 0)\n            {\n                death.Event.Raise();\n            }\n        }\n    }\n\n    public void ReportHealth(int health)\n    {\n        Debug.Log(gameObject.name + " reports: " +\n            "My health changed to " + health);\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.code,{children:"Monster"})," prefab's ",(0,s.jsx)(n.code,{children:"LogHealth"})," component, select ",(0,s.jsx)(n.code,{children:"Use Event Instancer"})," on the ",(0,s.jsx)(n.code,{children:"Death"})," Event reference field:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"death-event-reference",src:t(533).A+"",width:"547",height:"253"})}),"\n",(0,s.jsxs)(n.p,{children:["Add a ",(0,s.jsx)(n.code,{children:"Void Event Instancer"})," component and a create a ",(0,s.jsx)(n.code,{children:"Void Event"})," base Event in an asset folder. Select the base Event asset in the ",(0,s.jsx)(n.code,{children:"Base"})," field and drag the ",(0,s.jsx)(n.code,{children:"Void Event Instancer"})," component on the ",(0,s.jsx)(n.code,{children:"Death"})," field of ",(0,s.jsx)(n.code,{children:"LogHealth"}),":"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"death-event-assigned",src:t(4564).A+"",width:"547",height:"243"})}),"\n",(0,s.jsxs)(n.h2,{id:"listening-for-the-instantiated-death-event",children:["Listening for the instantiated ",(0,s.jsx)(n.code,{children:"Death"})," Event"]}),"\n",(0,s.jsxs)(n.p,{children:["To demonstrate the uniqueness of the ",(0,s.jsx)(n.code,{children:"Death"})," Event to each prefab, we'll add a method to ",(0,s.jsx)(n.code,{children:"LogHealth"})," called ",(0,s.jsx)(n.code,{children:"AnnounceDeath"})," that logs a customizable death message for the monster:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cs",children:'using UnityEngine;\nusing UnityAtoms.BaseAtoms;\n\npublic class LogHealth : MonoBehaviour\n{\n    [SerializeField]\n    private IntReference health;\n    [SerializeField]\n    private IntConstant startHealth;\n    [SerializeField]\n    private VoidBaseEventReference death;\n    [SerializeField]\n    private string deathMessage;\n\n    public void Start()\n    {\n        health.Value = startHealth.Value;\n    }\n\n    public void AnnounceDeath()\n    {\n        Debug.Log(gameObject.name + " " + deathMessage);\n    }\n\n    public void Damage(int damage)\n    {\n        if(health.Value > 0)\n        {\n            health.Value -= damage;\n\n            if(health.Value <= 0)\n            {\n                death.Event.Raise();\n            }\n        }\n    }\n\n    public void ReportHealth(int health)\n    {\n        Debug.Log(gameObject.name + " reports: " +\n            "My health changed to " + health);\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Now add a ",(0,s.jsx)(n.code,{children:"Void Base Event Reference Listener"})," to ",(0,s.jsx)(n.code,{children:"Monster"})," prefab. Wire it to the ",(0,s.jsx)(n.code,{children:"Void Event Instancer"})," component and ",(0,s.jsx)(n.code,{children:"AnnounceDeath"})," method using what you learned in this tutorial. The end result looks like this:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"death-listener",src:t(7293).A+"",width:"534",height:"293"})}),"\n",(0,s.jsxs)(n.h2,{id:"testing-the-event-instancer",children:["Testing the ",(0,s.jsx)(n.code,{children:"Event Instancer"})]}),"\n",(0,s.jsxs)(n.p,{children:["Since all of the work was done in a base prefab ",(0,s.jsx)(n.code,{children:"Monster"}),", the changes have automatically propagated to the ",(0,s.jsx)(n.code,{children:"Wyvern"})," and ",(0,s.jsx)(n.code,{children:"Orc"})," variants. Visit the variants and write a different death message for each in the ",(0,s.jsx)(n.code,{children:"deathMessage"})," field of ",(0,s.jsx)(n.code,{children:"LogHealth"}),":"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"orc-death-message",src:t(4009).A+"",width:"534",height:"132"})}),"\n",(0,s.jsxs)(n.p,{children:["Run the project and inflict damage using the ",(0,s.jsx)(n.code,{children:"Raise"})," button in ",(0,s.jsx)(n.code,{children:"HurtAllMonsters"})," Event's Inspector. Eventually the monsters will run out of health one by one and they should announce their unique death messages:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"unique-death-messages",src:t(9153).A+"",width:"600",height:"259"})}),"\n",(0,s.jsx)(n.p,{children:"That's it! You've created an extensible system where every new prefab variant can easily be customized and all the Atoms included in the prefab are automatically wired to correct responses. Use the monster's death Event Listener to play a sound, play an animation, and add experience points for the player. Only your imagination is the limit!"})]})}function c(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);